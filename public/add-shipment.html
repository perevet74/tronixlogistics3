<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add Shipment - Admin</title>
    <link rel="stylesheet" href="/public/css/style.css">
    <style>
        .admin-header {
            background: #2c3e50;
            color: #fff;
            padding: 20px 0;
            margin-bottom: 30px;
        }
        .admin-header .container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }
        .admin-nav {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }
        .admin-nav a {
            color: #fff;
            text-decoration: none;
            padding: 8px 15px;
            border-radius: 5px;
            transition: background 0.3s;
        }
        .admin-nav a:hover,
        .admin-nav a.active {
            background: #ff6b35;
        }
        .form-container {
            background: #fff;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            max-width: 1200px;
        }
        .form-section {
            margin-bottom: 40px;
            padding-bottom: 30px;
            border-bottom: 2px solid #f0f0f0;
        }
        .form-section:last-child {
            border-bottom: none;
        }
        .form-section h3 {
            color: #2c3e50;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #ff6b35;
        }
        .form-row {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 20px;
        }
        .form-row-3 {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 20px;
        }
        .form-group {
            margin-bottom: 20px;
        }
        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #2c3e50;
            font-weight: 600;
        }
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 15px;
            box-sizing: border-box;
            font-family: inherit;
        }
        .form-group textarea {
            resize: vertical;
        }
        .form-group input[type="checkbox"] {
            width: auto;
            margin-right: 8px;
        }
        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }
        .required {
            color: #e74c3c;
        }
        .notification-info {
            background: #e7f3ff;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            border-left: 4px solid #3498db;
        }
        @media (max-width: 768px) {
            .form-row, .form-row-3 {
                grid-template-columns: 1fr;
            }
            .checkbox-group {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="admin-header">
        <div class="container">
            <h2>Admin Panel - Tronixs Express</h2>
            <div class="admin-nav">
                <a href="dashboard.html">Dashboard</a>
                <a href="shipments.html">Shipments</a>
                <a href="add-shipment.html" class="active">Add Shipment</a>
                <a href="quotes.html">Quotes</a>
                <a href="login.html" onclick="logout()">Logout</a>
            </div>
        </div>
    </div>

    <div class="container">
        <h1>Add New Shipment</h1>
        
        <div class="form-container">
            <div class="notification-info">
                <strong>ðŸ“§ Email & SMS Notifications:</strong> When a shipment is created or updated, both sender and recipient will automatically receive email and SMS notifications with tracking information.
            </div>
            
            <form>
                <!-- Tracking Information -->
                <div class="form-section">
                    <h3>Tracking Information</h3>
                    <div class="form-group">
                        <label>Tracking Number <span class="required">*</span></label>
                        <input type="text" name="tracking_number" id="tracking_number" required readonly>
                        <small style="color: #666; display: block; margin-top: 5px;">Tracking number is automatically generated</small>
                        <button type="button" id="generateTrackingBtn" style="margin-top: 10px; padding: 8px 16px; background: #3498db; color: #fff; border: none; border-radius: 5px; cursor: pointer;">Generate New Number</button>
                    </div>
                </div>

                <!-- Sender Information -->
                <div class="form-section">
                    <h3>Sender Information</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Sender Name <span class="required">*</span></label>
                            <input type="text" name="sender_name" required placeholder="John Smith">
                        </div>
                        <div class="form-group">
                            <label>Sender Email <span class="required">*</span></label>
                            <input type="email" name="sender_email" required placeholder="sender@email.com">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Sender Phone <span class="required">*</span></label>
                            <input type="tel" name="sender_phone" required placeholder="+1 (555) 123-4567">
                        </div>
                        <div class="form-group">
                            <label>Sender Country</label>
                            <input type="text" name="sender_country" placeholder="United States">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Sender Address</label>
                        <textarea name="sender_address" rows="2" placeholder="123 Main St, New York, NY 10001"></textarea>
                    </div>
                    <div class="form-row-3">
                        <div class="form-group">
                            <label>City</label>
                            <input type="text" name="sender_city" placeholder="New York">
                        </div>
                        <div class="form-group">
                            <label>State/Province</label>
                            <input type="text" name="sender_state" placeholder="NY">
                        </div>
                        <div class="form-group">
                            <label>ZIP/Postal Code</label>
                            <input type="text" name="sender_zip" placeholder="10001">
                        </div>
                    </div>
                </div>

                <!-- Recipient Information -->
                <div class="form-section">
                    <h3>Recipient Information</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Recipient Name <span class="required">*</span></label>
                            <input type="text" name="recipient_name" required placeholder="Jane Doe">
                        </div>
                        <div class="form-group">
                            <label>Recipient Email <span class="required">*</span></label>
                            <input type="email" name="recipient_email" required placeholder="recipient@email.com">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Recipient Phone <span class="required">*</span></label>
                            <input type="tel" name="recipient_phone" required placeholder="+1 (555) 123-4567">
                        </div>
                        <div class="form-group">
                            <label>Recipient Country</label>
                            <input type="text" name="recipient_country" placeholder="United Kingdom">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Recipient Address</label>
                        <textarea name="recipient_address" rows="2" placeholder="456 Oak Ave, London, UK"></textarea>
                    </div>
                    <div class="form-row-3">
                        <div class="form-group">
                            <label>City</label>
                            <input type="text" name="recipient_city" placeholder="London">
                        </div>
                        <div class="form-group">
                            <label>State/Province</label>
                            <input type="text" name="recipient_state" placeholder="England">
                        </div>
                        <div class="form-group">
                            <label>ZIP/Postal Code</label>
                            <input type="text" name="recipient_zip" placeholder="SW1A 1AA">
                        </div>
                    </div>
                </div>

                <!-- Shipping Details -->
                <div class="form-section">
                    <h3>Shipping Details</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Origin <span class="required">*</span></label>
                            <input type="text" name="origin" required placeholder="New York, USA">
                        </div>
                        <div class="form-group">
                            <label>Destination <span class="required">*</span></label>
                            <input type="text" name="destination" required placeholder="London, UK">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Service Type <span class="required">*</span></label>
                            <select name="service_type" required>
                                <option value="">Select Service</option>
                                <option value="Air Freight">Air Freight</option>
                                <option value="Road Freight">Road Freight</option>
                                <option value="Ocean Freight">Ocean Freight</option>
                                <option value="Rail Freight">Rail Freight</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Status</label>
                            <select name="status">
                                <option value="Pending" selected>Pending</option>
                                <option value="Processing">Processing</option>
                                <option value="In Transit">In Transit</option>
                                <option value="Out for Delivery">Out for Delivery</option>
                                <option value="Delivered">Delivered</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Current Location</label>
                        <input type="text" name="current_location" placeholder="Current location of shipment">
                    </div>
                    <div class="form-group">
                        <label>Estimated Delivery Date</label>
                        <input type="date" name="estimated_delivery_date">
                    </div>
                </div>

                <!-- Cargo Information -->
                <div class="form-section">
                    <h3>Cargo Information</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Cargo Type</label>
                            <select name="cargo_type">
                                <option value="">Select Cargo Type</option>
                                <option value="General">General Cargo</option>
                                <option value="Electronics">Electronics</option>
                                <option value="Clothing">Clothing & Textiles</option>
                                <option value="Food">Food & Beverages</option>
                                <option value="Machinery">Machinery & Equipment</option>
                                <option value="Pharmaceuticals">Pharmaceuticals</option>
                                <option value="Automotive">Automotive Parts</option>
                                <option value="Documents">Documents</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Quantity</label>
                            <input type="number" name="quantity" min="1" value="1">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Cargo Description</label>
                        <textarea name="cargo_description" rows="3" placeholder="Detailed description of the cargo"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Cargo Photo (Optional)</label>
                        <input type="file" name="cargo_photo" id="cargo_photo" accept="image/*" style="padding: 8px; border: 1px solid #ddd; border-radius: 5px; width: 100%; box-sizing: border-box;">
                        <small style="color: #666; display: block; margin-top: 5px;">Upload a photo of the cargo being shipped (JPG, PNG, GIF - Max 5MB)</small>
                        <div id="photoPreview" style="margin-top: 15px; display: none;">
                            <img id="previewImage" src="" alt="Cargo Preview" style="max-width: 300px; max-height: 300px; border: 2px solid #ddd; border-radius: 5px; padding: 5px; background: #f9f9f9;">
                            <button type="button" id="removePhotoBtn" style="display: block; margin-top: 10px; padding: 8px 16px; background: #e74c3c; color: #fff; border: none; border-radius: 5px; cursor: pointer;">Remove Photo</button>
                        </div>
                    </div>
                </div>

                <!-- Weight & Dimensions -->
                <div class="form-section">
                    <h3>Weight & Dimensions</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Weight</label>
                            <input type="number" name="weight" step="0.01" min="0" placeholder="0.00">
                        </div>
                        <div class="form-group">
                            <label>Weight Unit</label>
                            <select name="weight_unit">
                                <option value="kg" selected>Kilograms (kg)</option>
                                <option value="lbs">Pounds (lbs)</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row-3">
                        <div class="form-group">
                            <label>Length</label>
                            <input type="number" name="length" step="0.01" min="0" placeholder="0.00">
                        </div>
                        <div class="form-group">
                            <label>Width</label>
                            <input type="number" name="width" step="0.01" min="0" placeholder="0.00">
                        </div>
                        <div class="form-group">
                            <label>Height</label>
                            <input type="number" name="height" step="0.01" min="0" placeholder="0.00">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Dimension Unit</label>
                        <select name="dimension_unit">
                            <option value="cm" selected>Centimeters (cm)</option>
                            <option value="in">Inches (in)</option>
                            <option value="m">Meters (m)</option>
                            <option value="ft">Feet (ft)</option>
                        </select>
                    </div>
                </div>

                <!-- Value & Insurance -->
                <div class="form-section">
                    <h3>Value & Insurance</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Declared Value</label>
                            <input type="number" name="declared_value" step="0.01" min="0" placeholder="0.00">
                        </div>
                        <div class="form-group">
                            <label>Currency</label>
                            <select name="currency">
                                <option value="USD" selected>USD ($)</option>
                                <option value="EUR">EUR (â‚¬)</option>
                                <option value="GBP">GBP (Â£)</option>
                                <option value="CAD">CAD ($)</option>
                                <option value="AUD">AUD ($)</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" name="insurance" value="1">
                            Require Insurance
                        </label>
                    </div>
                    <div class="form-group">
                        <label>Insurance Value</label>
                        <input type="number" name="insurance_value" step="0.01" min="0" placeholder="0.00">
                    </div>
                </div>

                <!-- Special Requirements -->
                <div class="form-section">
                    <h3>Special Requirements</h3>
                    <div class="checkbox-group">
                        <label>
                            <input type="checkbox" name="fragile" value="1">
                            Fragile - Handle with Care
                        </label>
                        <label>
                            <input type="checkbox" name="hazardous" value="1">
                            Hazardous Materials
                        </label>
                        <label>
                            <input type="checkbox" name="temperature_controlled" value="1">
                            Temperature Controlled
                        </label>
                        <label>
                            <input type="checkbox" name="requires_signature" value="1">
                            Requires Signature on Delivery
                        </label>
                    </div>
                    <div class="form-group">
                        <label>Special Instructions</label>
                        <textarea name="special_instructions" rows="3" placeholder="Any special handling instructions or requirements"></textarea>
                    </div>
                </div>
                
                <button type="submit" class="btn-primary">Add Shipment & Send Notifications</button>
                <a href="shipments.html" style="margin-left: 10px; color: #666;">Cancel</a>
            </form>
        </div>
    </div>
    <script>
        // Function to generate a unique tracking number
        function generateTrackingNumber() {
            // Format: TRX + 9 random digits
            const prefix = 'TRX';
            const randomDigits = Math.floor(100000000 + Math.random() * 900000000); // 9-digit number
            return prefix + randomDigits;
        }

        // Generate tracking number on page load
        document.addEventListener('DOMContentLoaded', function() {
            const trackingInput = document.getElementById('tracking_number');
            const generateBtn = document.getElementById('generateTrackingBtn');
            
            // Generate initial tracking number
            trackingInput.value = generateTrackingNumber();
            
            // Generate new number when button is clicked
            generateBtn.addEventListener('click', function() {
                trackingInput.value = generateTrackingNumber();
            });

            // Photo preview functionality
            const photoInput = document.getElementById('cargo_photo');
            const photoPreview = document.getElementById('photoPreview');
            const previewImage = document.getElementById('previewImage');
            const removePhotoBtn = document.getElementById('removePhotoBtn');

            photoInput.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    // Check file size (5MB max)
                    if (file.size > 5 * 1024 * 1024) {
                        alert('File size must be less than 5MB');
                        photoInput.value = '';
                        return;
                    }

                    // Check file type
                    if (!file.type.match('image.*')) {
                        alert('Please select an image file');
                        photoInput.value = '';
                        return;
                    }

                    // Show preview
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        previewImage.src = e.target.result;
                        photoPreview.style.display = 'block';
                    };
                    reader.readAsDataURL(file);
                }
            });

            // Remove photo
            removePhotoBtn.addEventListener('click', function() {
                photoInput.value = '';
                previewImage.src = '';
                photoPreview.style.display = 'none';
            });
        });

        // Authentication check - redirect to login if not authenticated
        (function() {
            if (sessionStorage.getItem('adminAuthenticated') !== 'true') {
                window.location.href = 'login.html';
            }
        })();

        // Logout function
        function logout() {
            sessionStorage.removeItem('adminAuthenticated');
            sessionStorage.removeItem('adminUsername');
            sessionStorage.removeItem('adminLoginTime');
            window.location.href = 'login.html';
        }

        // Handle logout link clicks
        document.addEventListener('DOMContentLoaded', function() {
            const logoutLink = document.querySelector('a[href="login.html"]');
            if (logoutLink && logoutLink.textContent.includes('Logout')) {
                logoutLink.addEventListener('click', function(e) {
                    e.preventDefault();
                    logout();
                });
            }
        });
    </script>
</body>
</html>
